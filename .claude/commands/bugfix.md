# バグ修正ワークフロー

TDD（Red-Green-Refactor）でバグ修正を行うワークフローです。

## 使い方

````bash
/wf-bugfix バグの内容や再現手順
```bash

---

## STEP 1: 作業ログ作成

`docs/tasks/ai-logs/YYYY-MM-DD_{slug}.md` に作業ログを作成すること。

**テンプレート:**

```markdown
# {タイトル}

## 概要

{作業内容の説明}

## 作業内容

{実施した内容を記録}

## 検証結果

{テストや動作確認の結果}

---

## 発生した問題・はまったこと

### 問題1: {問題の概要}

**現象**:
**原因**:
**解決策**:
**今後の注意点**:

## 振り返り

### 学んだこと

-

### ドキュメント・ルール更新の提案

| 対象ファイル | 更新内容 |
| ------------ | -------- |
|              |          |
```bash

## STEP 2: 再現確認

バグを再現すること。

## STEP 3: テスト作成 (Red)

バグが修正されたことを確認できるテストを書くこと。
この時点でテストは失敗する状態であること。
テストが書けない場合は、動作確認項目を定義すること。

## STEP 4: 修正 (Green)

原因を特定し、最小限の修正を行うこと。
問題が発生した場合は作業ログに記録すること。

## STEP 5: 検証

以下を順番に実行すること。

### 1. 静的解析

```bash
devbox run lint
```bash

エラーが出た場合は修正すること。

### 2. フォーマット確認

```bash
devbox run format
```bash

変更があった場合はコミットに含めること。

### 3. テスト実行

```bash
# TypeScript
devbox run test:ts

# Dart
devbox run test:dart
```bash

失敗した場合は修正すること。

### 4. 動作確認

- AI で確認可能な場合: 動作確認を実施する
- AI で確認不可能な場合: ユーザーに確認を依頼する

## STEP 6: セルフレビュー

作業内容に応じて適切な役割を選択し、その観点でレビューを行うこと。
問題があれば修正し、STEP 5 に戻ること。

**共通の観点:**

- **セキュリティ**: 認証・認可の漏れ、バリデーション不足、機密情報の露出、OWASP Top 10
- **品質・設計**: エッジケース、命名、パフォーマンス、エラーハンドリング、可読性・保守性
- **テスト**: テストケースの十分さ（正常系・異常系・境界値）、テストの意図
- **ミニマリスト**: 余計な変更、不要な抽象化、YAGNI 原則

**言語別の観点（該当する場合）:**

- **TypeScript**: 型定義、null/undefined の扱い、非同期処理
- **Dart/Flutter**: null safety、Widget 分割、状態管理
- **Swift/iOS**: Optional の扱い、メモリ管理、Protocol 指向

## STEP 7: 完了

1. 作業ログの「振り返り」セクションを記入すること
2. 必要に応じてドキュメント・ルールを更新すること
3. Git コミットすること
4. ユーザーに完了報告すること
````
