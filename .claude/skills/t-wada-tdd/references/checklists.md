# TDD チェックリスト

各フェーズで確認すべき項目をまとめたチェックリスト。

## フェーズ別チェックリスト

### テストリスト作成時

- [ ] 正常系のシナリオを網羅したか
- [ ] 異常系のシナリオを含めたか
- [ ] 境界値を含めたか
- [ ] エッジケースを考慮したか
- [ ] シナリオは具体的か（曖昧でないか）
- [ ] 優先順位を付けたか（簡単なものから）

### Red フェーズ

- [ ] テストリストから 1 つだけ選んだか
- [ ] テストが失敗することを確認したか
- [ ] 失敗理由は期待通りか
- [ ] テスト名は意図を表しているか
- [ ] AAA パターンで構造化されているか
- [ ] 既存のテストは全て通っているか

### Green フェーズ

- [ ] テストが通るようになったか
- [ ] 最小限の変更で済ませたか
- [ ] 既存のテストも全て通っているか
- [ ] リファクタリングは**していない**か
- [ ] 新機能は**追加していない**か

### Refactor フェーズ

- [ ] テストが全て通っているか（変更前）
- [ ] 重複を除去したか
- [ ] 命名は適切か
- [ ] 小さな変更を積み重ねたか
- [ ] 各変更後にテストを実行したか
- [ ] 新機能は**追加していない**か
- [ ] テストが全て通っているか（変更後）

### サイクル完了時

- [ ] テストリストを更新したか
- [ ] 新しいシナリオを発見したら追加したか
- [ ] 完了したシナリオにチェックを付けたか
- [ ] 次のサイクルに進む準備はできたか

## テスト品質チェックリスト

### テストコードの品質

- [ ] テストは独立しているか（他のテストに依存しない）
- [ ] テストは繰り返し実行できるか（冪等性）
- [ ] テストは高速か
- [ ] テストは自己検証できるか（成功/失敗が自動判定）
- [ ] テストはタイムリーに書かれたか（コードより先）

### テストの信頼性

- [ ] テストを削除してもプロダクトコードは壊れるか（偽陽性でない）
- [ ] プロダクトコードのバグでテストは失敗するか（偽陰性でない）
- [ ] テストは意図を明確に表現しているか
- [ ] テストはドキュメントとして読めるか

### テストカバレッジ

- [ ] 正常系がカバーされているか
- [ ] 異常系がカバーされているか
- [ ] 境界値がカバーされているか
- [ ] エッジケースがカバーされているか

## レガシーコードへの TDD 適用

### 準備

- [ ] 変更対象のコードを特定したか
- [ ] 依存関係を把握したか
- [ ] テスト可能な接合部（Seam）を見つけたか

### 特性テスト（Characterization Test）

- [ ] 現在の振る舞いを記録するテストを書いたか
- [ ] 期待値は現在の出力をそのまま使ったか
- [ ] 変更前の振る舞いを保護できているか

### リファクタリング

- [ ] テストで保護してからリファクタリングしたか
- [ ] 小さなステップで進めたか
- [ ] 各ステップでテストを実行したか

## TDD アンチパターン検出

### テストリスト

- [ ] ❌ テストリストなしで始めていないか
- [ ] ❌ リストが大きすぎないか（分割を検討）
- [ ] ❌ リストが抽象的すぎないか

### Red

- [ ] ❌ Red をスキップしていないか
- [ ] ❌ 複数のテストを同時に書いていないか
- [ ] ❌ 実装してからテストを書いていないか

### Green

- [ ] ❌ 過度に一般化していないか
- [ ] ❌ きれいなコードを書こうとしていないか
- [ ] ❌ 複数のテストを同時に通そうとしていないか

### Refactor

- [ ] ❌ 新機能を追加していないか
- [ ] ❌ テストなしで変更していないか
- [ ] ❌ 大きな変更を一度にしていないか

## 実践フローチェック

### TDD セッション開始前

```markdown
## 準備チェック

- [ ] テスト環境が動作する
- [ ] テストランナーが設定されている
- [ ] 既存のテストが全て通る
- [ ] 開発対象の仕様を理解している
```

### TDD セッション中

```markdown
## サイクル N 回目

### テストリスト

- [ ] シナリオ 1
- [ ] シナリオ 2
- ...

### 現在のサイクル

- [ ] Red: テスト「{テスト名}」を書いた
- [ ] Red: 失敗を確認した
- [ ] Green: 最小限の実装で通した
- [ ] Refactor: 必要な改善を行った
- [ ] 全テストが通ることを確認した
```

### TDD セッション終了後

```markdown
## 終了チェック

- [ ] 全てのテストが通る
- [ ] コードがコミット可能な状態
- [ ] テストリストを更新した
- [ ] 次回のタスクが明確
```

## 歩幅調整チェック

### 歩幅を小さくすべきサイン

- [ ] テストが予想外に失敗する
- [ ] 実装方法がわからない
- [ ] 不安を感じる
- [ ] 複数の変更が必要そう

### 歩幅を大きくしてもよいサイン

- [ ] 実装が自明である
- [ ] 自信がある
- [ ] 似たパターンを何度も実装した
- [ ] テストが安定して通っている

## クイックリファレンス

### TDD の 5 ステップ

1. テストリストを書く
2. 1 つ選んでテストを書く（Red）
3. テストを通す（Green）
4. リファクタリング（Refactor）
5. リストが空になるまで繰り返す

### 実装パターン

| パターン   | 使いどころ         |
| ---------- | ------------------ |
| 仮実装     | 最初の一歩、不安時 |
| 三角測量   | 一般化の方向が不明 |
| 明白な実装 | 自信がある時       |

### フェーズごとの目標

| フェーズ | 目標                               |
| -------- | ---------------------------------- |
| Red      | テストが失敗することを確認         |
| Green    | 動くコード（きれいさは追求しない） |
| Refactor | きれいなコード（機能追加はしない） |
